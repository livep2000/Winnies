$.widget("apps.calculator",$.winnies.appDialog,{version:"1.0.0",doLog:!0,Calculator:{runningTotal:"",currentVal:"",setCurrentVal:!1,executeAction:"",display:"",adjustTotals:function(a){this.setCurrentVal?this.currentVal+=a:this.runningTotal+=a},add:function(){this.runningTotal=parseInt(this.runningTotal)+parseInt(this.currentVal)},subtract:function(){this.runningTotal=parseInt(this.runningTotal)-parseInt(this.currentVal)},multiply:function(){this.runningTotal=parseInt(this.runningTotal)*parseInt(this.currentVal)},divide:function(){this.runningTotal=parseInt(this.runningTotal)/parseInt(this.currentVal)},clear:function(){this.runningTotal="",this.currentVal="",this.executeAction="",this.setCurrentVal=!1,this.display=""},resetCurrentVal:function(){this.currentVal=""},calculate:function(){return this.executeAction="",this.currentVal="",this.runningTotal},getAction:function(a){var b="";switch(a){case"+":b=this.add;break;case"-":b=this.subtract;break;case"x":b=this.multiply;break;case"/":b=this.divide}return b},setDisplay:function(){return this.display=""==this.currentVal?this.runningTotal:this.currentVal}},_init:function(){this._super()},_create:function(){console.debug("CREATE!");var a=this;this.element.find("div.key").click(function(){console.debug("CLICK!");var b=$(this),c=b.hasClass("action"),d=b.hasClass("instant"),e=b.text();if(c)if(d)switch(""!=a.Calculator.executeAction&&a.Calculator.executeAction(),e){case"cl":method=a.Calculator.clear();break;case"=":method=a.Calculator.calculate()}else""!=a.Calculator.executeAction&&a.Calculator.executeAction(),a.Calculator.executeAction=a.Calculator.getAction(e),a.Calculator.setCurrentVal=!0,a.Calculator.resetCurrentVal();else a.Calculator.adjustTotals(e);a.Calculator.setDisplay(),a.refreshVal()}),this._super()},refreshVal:function(){$(".calculator input[type=text]").val(this.Calculator.display)},_setOption:function(a,b){this._super(a,b)},_setOptions:function(a){this._super(a)},_destroy:function(){this._super()},_trigger:function(a,b,c){"close"==a&&this._destroy(),this._super(a,b,c)}});