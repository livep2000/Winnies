$.widget("apps.rss",$.winnies.appDialog,{version:"1.0.0",doLog:!0,MaxCount:50,ShowDesc:!0,ShowPubDate:!0,DescCharacterLimit:0,TitleLinkTarget:"_blank",DateFormat:"",DateFormatLang:"en",refreshTime:60,timer:null,_init:function(){this._super()},_create:function(){this._super()},contentReady:function(){var a=this,b=["http://feeds.livep2000.nl","http://feeds.reuters.com/reuters/scienceNews","http://feeds.reuters.com/reuters/technologyNews","http://feeds.reuters.com/Reuters/worldNews","http://www.drdobbs.com/rss/all"];this.element.find("._winnies_rss_urls").autocomplete({source:b,position:{my:"right top",at:"right bottom"},select:function(b,c){a.refresh(c.item.value,a.element.find("._winnies_rss_container"),a.refreshTime)}}).val(b[4]),this.refresh(b[4],this.element.find("._winnies_rss_container"),this.refreshTime)},refresh:function(a,b,c){var d=this;clearInterval(this.timer),this.getFeed(a,function(e,f){return e?console.error(e.statusText):void d.processFeed(f,b,function(e,f){d.timer=setInterval(function(){d.refresh(a,b,c)},1e3*c)})})},processFeed:function(a,b,c){var d,e="",f=this;b.empty(),a.query.results.rss instanceof Array||(a.query.results.rss=[a.query.results.rss]),$.each(a.query.results.rss,function(a,b){if(e+='<li><div class="itemTitle"><a href="'+b.channel.item.link+'" target="'+this.TitleLinkTarget+'" >'+b.channel.item.title+"</a></div>",f.ShowPubDate){if(d=new Date(b.channel.item.pubDate),e+='<div class="itemDate">',$.trim(this.DateFormat).length>0)try{moment.lang(f.DateFormatLang),e+=moment(d).format(f.DateFormat)}catch(a){e+=d.toLocaleDateString()}else e+=d.toLocaleDateString();e+="</div>"}f.ShowDesc&&(e+='<div class="itemContent">',e+=f.DescCharacterLimit>0&&b.channel.item.description.length>f.DescCharacterLimit?b.channel.item.description.substring(0,f.DescCharacterLimit)+"...":b.channel.item.description,e+="</div>")}),b.append('<ul class="feedEkList">'+e+"</ul>"),c(null,!0)},getFeed:function(a,b){var c='SELECT channel.item FROM feednormalizer WHERE output="rss_2.0" AND url ="'+a+'" LIMIT '+this.MaxCount;$.ajax({url:"https://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent(c)+"&format=json&diagnostics=false&callback=?",dataType:"json"}).done(function(a){b(null,a)}).fail(function(a){b(a,null)})},_setOption:function(a,b){this._super(a,b)},_setOptions:function(a){this._super(a)},_destroy:function(){this._super()},_trigger:function(a,b,c){"close"==a&&this._destroy(),"open"==a&&this.contentReady(),this._super(a,b,c)},logging:function(a){this.doLog&&console.log("RSS :: "+a)}});